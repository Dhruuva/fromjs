(function(){function C(a,d,b){if(a.length==d)return b;a=a.substr(d);return/^[0-9]+$/.exec(a)?b+"["+a+"]":b+"."+a}function t(a,d,b){var c,e=I.exec(a);e?(c=[e[1]],a=e[2],d=Array(1)):(e=J.exec(a))?(c=e[1].split(/\s*,\s*/),a=e[2],d=Array(c.length)):d=Array(d);for(var e=0,h=d.length;e<h;++e)d[e]=0;var h=0,g="";if(c)for(;e=E.exec(a);)for(var f=e[0],m=0,q=c.length;m<q;++m){if(f==c[m]){++d[m];b&&(b.push(a.substring(h,e.index)),b.push(m),h=e.index+f.length);break}}else for(c="";e=E.exec(a);){f=e[0];q=f.charAt(0);
m=null;if("$"==q)if(q=f.length,2<=q&&"$"==f[1])++d[1],b&&(m=1,c=C(f,2,""));else{if(1==q||!(f in global))++d[0],b&&(m=0,c=C(f,1,""))}else"@"==q?(q=d.length-1,++d[q],b&&(m=q,c=C(f,1,""))):"#"==q&&(q=parseInt(f.substr(1)),++d[q],b&&(m=q,c=""));b&&null!==m&&(b.push(g+a.substring(h,e.index)),b.push(m),h=e.index+f.length,g=c,c="")}b&&b.push(g+a.substring(h,a.length));return d}function k(a,d,b){var c,e=I.exec(a);if(e)c=[e[1]],a=e[2];else if(e=J.exec(a))c=e[1].split(/\s*,\s*/),a=e[2];var h=arguments,g=0<
h.length?h[h.length-1]:"";return c?a.replace(E,function(a){for(var b=0,d=c.length;b<d;++b)if(a==c[b])return h[b+1];return a}):a.replace(E,function(a){var c=a.charAt(0);if("$"==c){c=a.length;if(2<=c&&"$"==a[1])return C(a,2,b);if(1==c||!(a in global))return C(a,1,d)}else{if("@"==c)return C(a,1,g);if("#"==c)return h[parseInt(a.substr(1))+1]}return a})}function s(a,d,b){for(var c=1,e=a.length;c<e;c+=2){var h=a[c];"number"==typeof h&&(a[c]=arguments[h+1])}return a.join("")}function F(a,d){if(!a)return null;
if("function"==typeof a)return a;var b,c=/^\s*(\w+)\s*=>(.+)$/.exec(a);if(c)b=[c[1]],a=c[2];else if(c=/^\s*\(\s*([\w\s,]*)\s*\)\s*=>(.+)$/.exec(a))b=c[1].split(/\s*,\s*/),a=c[2];if(!b){b=[];for(c=0;c<d;++c)b.push("$"+c);c=[a].concat(b);a=k.apply(null,c)}b.push("return "+a+";");return Function.apply(global,b)}function x(a){var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",
'"':'\\"',"\\":"\\\\"};return d.test(a)?'"'+a.replace(d,function(a){var d=b[a];return d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function A(a,d){var b=function(){};b.prototype=a.prototype;d.prototype=new b}function K(a,d){var b=a?a+"=":"";if("boolean"==typeof d)return b+(d?"1":"0");if("string"==typeof d)return b+encodeURIComponent(d);if("number"==typeof d)return b+d.toString();if("object"==typeof d){var c=[];r(d).each(function(b,d){d=encodeURIComponent(d);c.push(K(a?
a+"["+d+"]":d,b))});return c.join("&")}return""}function D(a,d){this.$o=r(this.o=[]);this.c=a;this.a=d}function G(){}function f(a){this.each=a}function u(a){this.str=a}function w(a){this.str=a}function p(a){this.data=a}function v(a){this.data=a}function y(a){this.data=a}function H(a){this.data=a}function B(a){this.Iterable=a;this.context=[]}function r(a){return a?a instanceof f?a:a.$each?new f(function(d,b){this.broken=!1===a.$each(d,b);return this}):"string"==typeof a?new u(a):a instanceof Array?
new p(a):new v(a):new f(function(){return this})}var z="from",L=[0," ","\n","\t"],I=/^\s*(\w+)\s*=>(.+)$/,J=/^\s*\(\s*([\w\s,]*)\s*\)\s*=>(.+)$/,E=/"(?:[^"]|\\")*"|'(?:[^']|\\')*'|[\$@\w_#]+/g;D.prototype._getPrimitiveList=function(a,d){var b=this[a];b||(this[a]=b={});d=d.toString();var c=b[d];c||(b[d]=c=[],this.o.push({k:d,l:c}));return c};D.prototype._getList=function(a){var d=this.c,b;if(d)b="string"==typeof d?k(d,"$k","@k","@a"):"@c($k,@k,@a)";else{switch(typeof a){case "string":return this._getPrimitiveList("s",
a);case "number":return this._getPrimitiveList("n",a);case "boolean":return this._getPrimitiveList("b",a)}b="$k==@k"}if(d=this.$o.first(b,{k:a,c:d,a:this.a}))return d.l;d=[];this.o.push({k:a,l:d});return d};D.prototype.add=function(a,d){this._getList(a).push(d)};D.prototype.$each=function(a,d){this.broken=!this.$o.selectPair("from($l)","$k").each(a,d).broken;return this};G.prototype.getBucket=function(a){var d=this.cache;if(!d){this.cache=d={};var b=this;setTimeout(function(){b.cache=null},0)}var c=
d[a];c||(d[a]=c={});return c};G.prototype.get=function(a,d){return this.getBucket(a)[d]};G.prototype.set=function(a,d,b){this.getBucket(a)[d]=b};var l=new G;f.prototype.broken=!1;f.prototype.where=function(a,d){var b;"string"==typeof a?(b=l.get("($_$$_a0)",a),b||(b="("+k(a,"$","$$","@a0")+")",l.set("($_$$_a0)",a,b))):b="@pr($,$$,@a0)";var c=this;return new f(function(e,h){var g;"string"==typeof e?(g=l.get("($_$$_a)",e),g||(g="("+k(e,"$","$$","@a")+")",l.set("($_$$_a)",e,g))):g="@p($,$$,@a)";this.broken=
c.each(b+"?"+g+":0",{p:e,pr:a,a0:d,a:h}).broken;return this})};f.prototype.aggregate=function(a,d,b){var c;"string"==typeof d?(c=l.get("(c_$_$$_a)",d),c||(c="("+k(d,"@c","$","$$","@a")+")",l.set("(c_$_$$_a)",d,c))):c="@p(@c,$,$$,@a)";null===a?(a={p:d,f:!0,a:b},this.each("@f?(@f=false,@c=$,0):(@c="+c+",0)",a)):(a={c:a,a:b,p:d},this.each("(@c="+c+"),0",a));return a.c};f.prototype.all=function(a,d){var b;"string"==typeof a?(b=l.get("($_$$_a)",a),b||(b="("+k(a,"$","$$","@a")+")",l.set("($_$$_a)",a,b))):
b="@p($,$$,@a)";return!this.each("!"+b+"?false:0",{a:d,p:a}).broken};f.prototype.any=function(a,d){var b;a?"string"==typeof a?(b=l.get("($_$$_a)",a),b||(b="("+k(a,"$","$$","@a")+")",l.set("($_$$_a)",a,b))):b="@p($,$$,@a)":b="true";return this.each(b+"?false:0",{a:d,p:a}).broken};f.prototype.at=function(a){return this.skip(a).first()};f.prototype.atOrDefault=function(a,d){var b=this.at(a);return void 0===b?d:b};f.prototype.average=function(){var a={f:!0};this.each("@f?(@f=false,@s=$,@c=1,0):(@s+=$,++@c)",
a);return a.s/a.c};f.prototype.concat=function(a){var d=this;return new f(function(b,c){this.broken=!1;if(d.each(b,c).broken||a.each(b,c).broken)return this.broken=!0,this})};f.prototype.contains=function(a,d,b){var c;d?"string"==typeof d?(c=l.get("(v_$_a)",d),c||(c="("+k(d,"@v","$","@a")+")",l.set("(v_$_a)",d,c))):c="@c(@v,$,@a)":c="$==@v";a={v:a,a:b,c:d,r:!1};this.each(c+"?((@r=true),false):0",a);return a.r};f.prototype.count=function(a,d){var b;a?"string"==typeof a?(b=l.get("($_$$_a)",a),b||(b=
"("+k(a,"$","$$","@a")+")",l.set("($_$$_a)",a,b))):b="@p($,$$,@a)":b="true";var c={a:d,p:a,c:0};this.each(b+"?++@c:0",c);return c.c};f.prototype.defaultIfEmpty=function(a){var d=this;return new f(function(b,c){d.each("false").broken?this.broken=d.each(b,c).broken:("string"==typeof b&&(b=F(b,3)),this.broken=!1===b(a,0,c));return this})};f.prototype.distinct=function(a,d){var b=a?",@c,@a":"",c=[],e=r(c),h=this;return new f(function(d,f){var m;"string"==typeof d?(m=l.get("($_$$_a0)",d),m||(m="("+k(d,
"$","$$","@a0")+")",l.set("($_$$_a0)",d,m))):m="@p($,$$,@a0)";this.broken=h.each("!@ll.contains($"+b+")?(@l.push($),"+m+"):0",{c:a,ll:e,l:c,p:d,a0:f}).broken;return this})};f.prototype.except=function(a,d,b){var c;c=d?",@c,@a0":"";var e=this;return new f(function(h,g){this.broken="string"==typeof h?e.each("@s.contains($"+c+")?0:("+k(h,"$","$$","@a")+")",{c:d,a0:b,s:r(a),a:g}).broken:e.each("@s.contains($"+c+")?0:@p($,$$,@a)",{c:d,a0:b,p:h,s:r(a),a:g}).broken;return this})};f.prototype.first=function(a,
d){if(a)"string"==typeof a?(b={a:d},this.each("("+k(a,"$","$$","@a")+")?(@r=$,false):0",b)):(b={a:d,p:a},this.each("@p($,$$,@a)?(@r=$,false):0",b));else{var b={};this.each("(@r=$),false",b)}return b.r};f.prototype.firstOrDefault=function(a,d,b){if(1>=arguments.length){var c=this.first();return void 0===c?a:c}c=this.first(a,b);return void 0===c?d:c};f.prototype.groupBy=function(a,d,b){var c,e,h;a&&(c=a.value,e=a.key,h=a.result);c=c||"$";e=e||"$$";return h?(a="string"==typeof h?k(h,"$","$$","@a"):"@rs($,$$,@a)",
this._getGroupIterable(c,e,d,b).selectPair(a,"$$",{rs:h,a:b})):this._getGroupIterable(c,e,d,b)};f.prototype._getGroupIterable=function(a,d,b,c){b=new D(b,c);var e=r(b),h;h="string"==typeof d?"("+k(d,"$","$$","@a")+")":"@ks($,$$,@a)";var g;g="string"==typeof a?"("+k(a,"$","$$","@a")+")":"@vs($,$$,@a)";this.each("(@k="+h+"),(@v="+g+"),@g.add(@k,@v),0",{ks:d,vs:a,g:b,a:c});return e};f.prototype.groupJoin=function(a,d,b,c,e,h){a=r(a);d="string"==typeof d?"("+k(d,"$","$$","@a")+")":"@oks($,$$,@a)";b="string"==
typeof b?"("+k(b,"$","$$","@a")+")":"@iks($,$$,@a)";b=e?"string"==typeof e?k(e,"@ok",b):"@c(@ok,"+b+")":"@ok=="+b;b=x(b);d="@i.where("+b+",{a:@a,ok:"+d+",c:@c})";if("string"==typeof c)switch(b=[],t(c,3,b)[1]){case 0:case 1:d=s(b,"$",d,"@a");break;default:d="(@w="+d+"),("+s(b,"$","@w","@a")+")"}else d="@rs($,"+d+",@a)";return this.select(d,{rs:c,i:a,a:h,c:e})};f.prototype.intersect=function(a,d,b){var c;c=d?"string"==typeof d?x(d):"@c":"null";return this.where("@t.contains($,"+c+",@a)",{t:r(a),a:b,
c:d})};f.prototype.join=function(a,d,b,c,e,h){a=r(a);var g;g="string"==typeof d?"("+k(d,"$","$$","@a")+")":"@oks($,$$,@a)";var n;n="string"==typeof b?"("+k(b,"$","$$","@a")+")":"@iks($,$$,@a)";var m;m=e?"string"==typeof e?k(e,"@ok",n):"@c(@ok,"+n+")":"@ok=="+n;m=x(m);var q;q="string"==typeof c?"("+k(c,"@ov","$","@a")+")":"@rs(@ov,$,@a)";var l=this;return new f(function(e,f){var n;if("string"==typeof e){n=[];var k=t(e,3,n),r=[],p;switch(k[0]){case 0:case 1:p=q;break;default:r.push("(@RS="+q+")"),p=
"@RS"}switch(k[1]){case 0:case 1:k="(@c++)";break;default:r.push("(@cc=@c++)"),k="@cc"}r.push("("+s(n,p,k,"@a0")+")");n=r.join(",")}else n="@p("+q+",@c++,@a0)";this.broken=l.each("(@ok="+g+"),(@ov=$),@i.where("+m+",@).each("+x(n)+",@)",{i:a,oks:d,iks:b,rs:c,p:e,a:h,a0:f,c:0}).broken;return this})};f.prototype.last=function(a,d){if(a)"string"==typeof a?(b={a:d},this.each("("+k(a,"$","$$","@a")+")?@r=$:0",b)):(b={a:d,p:a},this.each("@p($,$$,@a)?@r=$:0",b));else{var b={};this.each("@r=$",b)}return b.r};
f.prototype.lastOrDefault=function(a,d,b){if(1>=arguments.length){var c=this.last();return void 0===c?a:c}c=this.last(a,b);return void 0===c?d:c};f.prototype.max=function(a,d){if(!a)return this.aggregate(null,"#0>#1?#0:#1");var b;b="string"==typeof a?"("+k(a,"$","$$","@a")+")":"@s($,$$,@a)";var c={f:!0,s:a,a:d};this.each("@f?((@f=false),(@r=$),(@m="+b+"),0):((@v="+b+"),(@v>@m?((@m=@v),(@r=$)):0),0)",c);return c.r};f.prototype.min=function(a,d){if(!a)return this.aggregate(null,"#0<#1?#0:#1");var b;
b="string"==typeof a?"("+k(a,"$","$$","@a")+")":"@s($,$$,@a)";var c={f:!0,s:a,a:d};this.each("@f?((@f=false),(@r=$),(@m="+b+"),0):((@v="+b+"),(@v<@m?((@m=@v),(@r=$)):0),0)",c);return c.r};f.prototype.orderBy=function(a,d,b){var c=new B(this);c._addContext(a||"$",d,!1,b);return c};f.prototype.orderByDesc=function(a,d,b){var c=new B(this);c._addContext(a||"$",d,!0,b);return c};f.prototype.reverse=function(){var a=this;return new f(function(d,b){var c=[];a.each("@push($$),@push($),0",c);if("string"==
typeof d){var e=[],h=t(d,3,e),f,n,m;switch(h[0]){case 0:case 1:f="";n="l[(i-1)*2+1]";break;default:f="var v=l[(i-1)*2+1];",n="v"}switch(h[1]){case 0:case 1:h="";m="l[(i-1)*2]";break;default:h="var k=l[(i-1)*2];",m="k"}this.broken=(new Function("l","a","for(var i=l.length/2;i>0;--i){"+h+f+"if(("+s(e,n,m,"a")+")===false){return true;}}return false;"))(c,b)}else{this.broken=!1;for(e=c.length/2;0<e;--e)if(!1===d(c[2*(e-1)+1],c[2*(e-1)],b)){this.broken=!0;break}}return this})};f.prototype.select=function(a,
d){var b=this,c;"string"==typeof a?(c=l.get("($_$$_a0)",a),c||(c="("+k(a,"$","$$","@a0")+")",l.set("($_$$_a0)",a,c))):c="@s($,$$,@a0)";return new f(function(e,h){if("string"==typeof e){var f=[],n=t(e,3,f),m=[],q;switch(n[0]){case 0:q="";break;case 1:q=c;break;default:m.push("(@v="+c+")"),q="@v"}switch(n[1]){case 0:n="";break;case 1:n="(@i++)";break;default:m.push("(@j=@i++)"),n="@j"}m.push(s(f,q,n,"@a"));this.broken=b.each(m.join(","),{s:a,a0:d,a:h,i:0}).broken}else this.broken=b.each("@p("+c+",@i++,@a)",
{s:a,a0:d,a:h,i:0,p:e}).broken;return this})};f.prototype.selectMany=function(a,d){var b;b="string"==typeof a?k(a,"$","$$","@a"):"@s($,$$,@a)";var c=this;return new f(function(e,h){var f;if("string"==typeof e)switch(f=[],t(e,3,f)[1]){case 0:case 1:f=s(f,"$","(@i++)","@a0");break;default:f="(@j=@i++),("+s(f,"$","@j","@a0")+")"}else f="@p($,@i++,@a0)";this.broken=c.each("from("+b+").each("+x(f)+",@)",{s:a,a:d,a0:h,i:0,p:e});return this})};f.prototype.selectPair=function(a,d,b){var c=this,e,h;"string"==
typeof a?(e=l.get("($_$$_a0)",a),e||(e="("+k(a,"$","$$","@a0")+")",l.set("($_$$_a0)",a,e))):e="@vs($,$$,@a0)";"string"==typeof d?(h=l.get("($_$$_a0)",d),h||(h="("+k(d,"$","$$","@a0")+")",l.set("($_$$_a0)",d,h))):h="@ks($,$$,@a0)";return new f(function(f,n){var m;if("string"==typeof f){m=[];var q=t(f,3,m),l,k=[];switch(q[0]){case 0:case 1:l=e;break;default:k.push("(@VS="+e+")"),l="@VS"}switch(q[1]){case 0:case 1:q=h;break;default:k.push("(@KS="+h+")"),q="@KS"}k.push(s(m,l,q,"@a"));m=k.join(",")}else m=
"@p("+e+","+h+",@a)";this.broken=c.each(m,{a0:b,a:n,p:f,vs:a,ks:d}).broken;return this})};f.prototype.sequenceEqual=function(a,d,b){var c;c=d?"string"==typeof d?k(d,"#0","#1","@a"):"@c(#0,#1,@a)":"#0==#1";return this.zip(a,c,{a:b,c:d}).all("$==true")};f.prototype.single=function(a,d){var b=!a?this.take(2):this.where(a).take(2);if(1==b.count())return b.first()};f.prototype.singleOrDefault=function(a,d,b){var c;1>=arguments.length?(c=this.take(2),d=a):c=this.where(a).take(2);var e=c.count();if(0==e)return d;
if(1==e)return c.first();throw Error("The sequence has more than one element satisfying the condition.");};f.prototype.skip=function(a){if(0>=a)return this;var d=this;return new f(function(b,c){var e;"string"==typeof b?(e=l.get("($_$$_a)",b),e||(e="("+k(b,"$","$$","@a")+")",l.set("($_$$_a)",b,e))):e="@p($,$$,@a)";this.broken=d.each("@c==0?"+e+":--@c",{p:b,a:c,c:a}).broken;return this})};f.prototype.skipWhile=function(a,d){var b;"string"==typeof a?(b=l.get("($_$$_a)",a),b||(b="("+k(a,"$","$$","@a")+
")",l.set("($_$$_a)",a,b))):b="@pr($,$$,@a)";var c=this;return new f(function(e,h){var f;"string"==typeof e?(f=l.get("($_$$_a0)",e),f||(f="("+k(e,"$","$$","@a0")+")",l.set("($_$$_a0)",e,f))):f="@p($,$$,@a0)";this.broken=c.each("@f||(@f=!"+b+")?"+f+":0",{pr:a,f:!1,a:d,a0:h}).broken;return this})};f.prototype.sum=function(){return this.aggregate(null,"#0+#1")};f.prototype.take=function(a){if(0==a)return r();if(0>a)return this.reverse().take(-a).reverse();var d=this;return new f(function(b,c){var e;
"string"==typeof b?(e=l.get("($_$$_a)",b),e||(e="("+k(b,"$","$$","@a")+")",l.set("($_$$_a)",b,e))):e="@p($,$$,@a)";var h={i:0,p:b,a:c,b:!1};this.broken=d.each("(@i++<"+a+")?"+e+":(@b=true,false)",h).broken&&!h.b;return this})};f.prototype.takeWhile=function(a,d){var b;"string"==typeof a?(b=l.get("($_$$_a)",a),b||(b="("+k(a,"$","$$","@a")+")",l.set("($_$$_a)",a,b))):b="@pr($,$$,@a)";var c=this;return new f(function(e,h){var f;"string"==typeof e?(f=l.get("($_$$_a0)",e),f||(f="("+k(e,"$","$$","@a0")+
")",l.set("($_$$_a0)",e,f))):f="@p($,$$,@a0)";var n={p:e,pr:a,a:d,a0:h,b:!1};this.broken=c.each(b+"?"+f+":(@b=true,false)",n).broken&&!n.b;return this})};f.prototype.toArray=function(){var a=[];this.each("@push($)",a);return a};f.prototype.toDictionary=function(){var a={};this.each("@[$$]=$",a);return a};f.prototype.toJSON=function(a){function d(c){var e=typeof c;return"string"==e?x(c):"number"==e||"boolean"==e?c.toString():"function"==e?d(c()):b.contains(c)||(c instanceof p||c instanceof v)&&b.contains(c.data)?
"null":r(c).toJSON(a)}a||(a=[]);var b=r(a),c="number"==typeof this.select("$$").first();a.push(this);if(c){var e=[];this.each(function(a){e.push(d(a))});c="["+e.join(", ")+"]"}else e=[],this.each(function(a,b){e.push(x(b.toString())+": "+d(a))}),c="{"+e.join(", ")+"}";a.pop(this);return c};f.prototype.toString=function(a){return this.toArray().join(a||"")};f.prototype.toURLEncoded=function(){return K(null,this)};f.prototype.trim=function(a,d,b){var c,e;if(!a||a instanceof Array||a instanceof f)c=
a||L,a=a instanceof f?"@.contains($)":"@.indexOf($)>=0";if(!d||d instanceof Array||d instanceof f)e=d||L,d=d instanceof f?"@.contains($)":"@.indexOf($)>=0";return this.skipWhile(a,c).reverse().skipWhile(d,e).reverse()};f.prototype.union=function(a,d,b){var c=[],e=r(c),h=this;return new f(function(f,n){var m;if("string"==typeof f)switch(m=[],t(f,3,m)[1]){case 0:case 1:m=s(m,"$","(@b.length-1)","@a0");break;default:m="(@bb=@b.length-1),("+s(m,"$","@bb","@a0")+")"}else m="@p($,@b.length-1,@a0)";m="@bi.contains($,@c,@a)?0:(@b.push($),"+
m+",0)";var q={c:d,b:c,bi:e,a0:n,a:b};if(h.each(m,q).broken)return this.broken=!0,this;r(a).each(m,q).broken&&(this.broken=!0);return this})};f.prototype.zip=function(a,d,b){var c;if("string"==typeof d){var e=[],h=t(d,5,e),g,n=[];switch(h[0]){case 0:case 1:g="@d[@i*2+1]";break;default:n.push("(@V=@d[@i*2+1])"),g="@V"}switch(h[2]){case 0:case 1:h="@d[@i*2]";break;default:n.push("(@K=@d[@i*2])"),h="@K"}n.push(s(e,g,"$",h,"$$","@a"));c="("+n.join(",")+")"}else c="@rs(@d[@i*2+1],$,@d[@i*2],$$,@a)";var m=
this;return new f(function(e,f){var h=[];m.each("@push($$),@push($),0",h);var n;if("string"==typeof e){n=[];var g=t(e,3,n),l,k=[];switch(g[0]){case 0:case 1:l=c;break;default:k.push("(@RS="+c+")"),l="@RS"}switch(g[1]){case 0:case 1:g="(@k++)";break;default:k.push("(@kk=@k++)"),g="@kk"}k.push(s(n,l,g,"@a0"));n="("+k.join(",")+")"}else n="@p("+c+",@k++,@a0)";this.broken=r(a).each("@i>="+h.length/2+"?false:@r="+n+",++@i,@r",{a:b,a0:f,k:0,i:0,d:h,p:e,rs:d}).broken;return this})};A(f,u);u.prototype.each=
function(a,d){var b=this.str;if("function"==typeof a){this.broken=!1;for(var c=0,e=b.length;c<e;++c)if(!1===a(b.charAt(c),c,d)){this.broken=!0;break}}else{c=l.get("each_s",a);if(!c){var c=[],f;switch(t(a,3,c)[0]){case 0:case 1:e="";f="s.charAt(i)";break;default:e="var v=s.charAt(i);",f="v"}c=new Function(z,"s","a","for(var i=0,c=s.length;i<c;++i){"+e+"if(("+s(c,f,"i","a")+")===false){return true;}}return false;");l.set("each_s",a,c)}this.broken=c(r,b,d)}return this};u.prototype.at=function(a){return this.str.charAt(a)};
u.prototype.count=function(a,d){return a?f.prototype.count.call(this,a,d):this.str.length};u.prototype.any=function(a,d){return a?f.prototype.any.call(this,a,d):0<this.str.length};u.prototype.first=function(a,d){var b=this.str;if(a)return f.prototype.first.call(this,a,d);if(0<b.length)return b.charAt(0)};u.prototype.last=function(a,d){var b=this.str;if(a)return this.reverse().first(a,d);var c=b.length;if(0<c)return b.charAt(c-1)};u.prototype.reverse=function(){return new w(this.str)};u.prototype.toString=
function(a){return a?f.prototype.toString.call(this,a):this.str};u.prototype.toJSON=function(){return x(this.str)};u.prototype.zip=function(a,d,b){var c;if("string"==typeof d){var e=[],h,g=[];switch(t(d,5,e)[0]){case 0:case 1:h="@d.charAt(@i)";break;default:g.push("(@V=@d.charAt(@i))"),h="@V"}g.push("("+s(e,h,"$","@i","$$","@a")+")");c="("+g.join(",")+")"}else c="@rs(@d.charAt(@i),$,@i,$$,@a)";var n=this;return new f(function(e,f){var h=n.str,g;if("string"==typeof e){g=[];var l=t(e,3,g),k,p=[];switch(l[0]){case 0:case 1:k=
c;break;default:p.push("(@RS="+c+")"),k="@RS"}switch(l[1]){case 0:case 1:l="(@k++)";break;default:p.push("(@kk=@k++)"),l="@kk"}p.push(s(g,k,l,"@a0"));g="("+p.join(",")+")"}else g="@p("+c+",@k++,@a0)";this.broken=r(a).each("@i>="+h.length+"?false:@r="+g+",++@i,@r",{a:b,a0:f,k:0,i:0,d:h,p:e,rs:d}).broken;return this})};A(u,w);w.prototype.each=function(a,d){var b=this.str;if("function"==typeof a){this.broken=!1;for(var c=b.length,e=c;0<e;--e)if(!1===a(b.charAt(e),c-e,d)){this.broken=!0;break}}else{c=
l.get("each_str",a);if(!c){var c=[],f=t(a,3,c),g,n;switch(f[0]){case 0:case 1:e="";g="s.charAt(i-1)";break;default:e="var v=s.charAt(i-1);",g="v"}switch(f[1]){case 0:case 1:f="";n="(c-i)";break;default:f="var k=c-i;",n="k"}c=new Function(z,"s","a","for(var i=s.length,c=i;i>0;--i){"+e+f+"if(("+s(c,g,n,"a")+")===false){return true;}}return false;");l.set("each_str",a,c)}this.broken=c(r,b,d)}return this};w.prototype.at=function(a){var d=this.str;return d.charAt(d.length-a-1)};w.prototype.first=function(a,
d){var b=this.str;if(a)return f.prototype.first.call(this,a,d);if(0<b.length)return b.charAt(b.length-1)};w.prototype.last=function(a,d){var b=this.str;if(a)return this.reverse().first(a,d);if(0<b.length)return b.charAt(0)};w.prototype.reverse=function(){return new u(this.str)};w.prototype.toString=f.prototype.toString;w.prototype.zip=function(a,d,b){var c=this.str,e=c.length,h;if("string"==typeof d){var g=[],n,m=[];switch(t(d,5,g)[0]){case 0:case 1:n="@d.charAt("+e+"-@i-1)";break;default:m.push("(@V=@d.charAt("+
e+"-@i-1))"),n="@V"}m.push("("+s(g,n,"$","@i","$$","@a")+")");h="("+m.join(",")+")"}else h="@rs(@d.charAt("+e+"-@i-1],$,@i,$$,@a)";return new f(function(f,m){var g;if("string"==typeof f){g=[];var n=t(f,3,g),l,k=[];switch(n[0]){case 0:case 1:l=h;break;default:k.push("(@RS="+h+")"),l="@RS"}switch(n[1]){case 0:case 1:n="(@k++)";break;default:k.push("(@kk=@k++)"),n="@kk"}k.push(s(g,l,n,"@a0"));g="("+k.join(",")+")"}else g="@p("+h+",@k++,@a0)";this.broken=r(a).each("@i>="+e+"?false:@r="+g+",++@i,@r",{a:b,
a0:m,k:0,i:0,d:c,p:f,rs:d}).broken;return this})};A(f,p);p.prototype.each=function(a,d){var b=this.data;if("function"==typeof a){this.broken=!1;for(var c=0,e=b.length;c<e;++c)if(!1===a(b[c],c,d)){this.broken=!0;break}}else{c=l.get("each_a",a);if(!c){var c=[],f;switch(t(a,3,c)[0]){case 0:case 1:e="";f="d[i]";break;default:e="var v=d[i];",f="v"}c=new Function(z,"d","a","for(var i=0,c=d.length;i<c;++i){"+e+"if(("+s(c,f,"i","a")+")===false){return true;}}return false;");l.set("each_a",a,c)}this.broken=
c(r,b,d)}return this};p.prototype.at=function(a){return this.data[a]};p.prototype.count=function(a,d){return a?f.prototype.count.call(this,a,d):this.data.length};p.prototype.any=function(a,d){return a?f.prototype.any.call(this,a,d):0<this.data.length};p.prototype.first=function(a,d){if(a)return f.prototype.first.call(this,a,d);var b=this.data;if(0<b.length)return b[0]};p.prototype.last=function(a,d){if(a)return this.reverse().first(a,d);var b=this.data;if(0<b.length)return b[b.length-1]};p.prototype.reverse=
function(){return new y(this.data)};p.prototype.toJSON=function(a){a?a.push(this.data):a=[this.data];var d=f.prototype.toJSON.call(this,a);a.pop();return d};p.prototype.zip=function(a,d,b){var c;if("string"==typeof d){var e=[],h,g=[];switch(t(d,5,e)[0]){case 0:case 1:h="@d[@i]";break;default:g.push("(@V=@d[@i])"),h="@V"}g.push("("+s(e,h,"$","@i","$$","@a")+")");c="("+g.join(",")+")"}else c="@rs(@d[@i],$,@i,$$,@a)";var n=this;return new f(function(e,f){var h=n.data,g;if("string"==typeof e){g=[];var l=
t(e,3,g),k,p=[];switch(l[0]){case 0:case 1:k=c;break;default:p.push("(@RS="+c+")"),k="@RS"}switch(l[1]){case 0:case 1:l="(@k++)";break;default:p.push("(@kk=@k++)"),l="@kk"}p.push(s(g,k,l,"@a0"));g="("+p.join(",")+")"}else g="@p("+c+",@k++,@a0)";this.broken=r(a).each("@i>="+h.length+"?false:@r="+g+",++@i,@r",{a:b,a0:f,k:0,i:0,d:h,p:e,rs:d}).broken;return this})};A(f,v);v.prototype.each=function(a,d){var b=this.data;if("function"==typeof a){this.broken=!1;for(var c in b)if(!1===a(b[c],c,d)){this.broken=
!0;break}}else{c=l.get("each_o",a);if(!c){c=[];var e,f;switch(t(a,3,c)[0]){case 0:case 1:e="";f="d[k]";break;default:e="var v=d[k];",f="v"}c=new Function(z,"d","a","for(var k in d){"+e+"if(("+s(c,f,"k","a")+")===false){return true;}}return false;");l.set("each_o",a,c)}this.broken=c(r,b,d)}return this};v.prototype.at=function(a){return this.skip(a).first()};v.prototype.reverse=function(){return new H(this.data)};v.prototype.toJSON=p.prototype.toJSON;A(p,y);y.prototype.each=function(a,d){var b=this.data;
if("function"==typeof a){this.broken=!1;for(var c=b.length,e=c;0<e;--e)if(!1===a(b[e],c-e,d)){this.broken=!0;break}}else{c=l.get("each_ar",a);if(!c){var c=[],f=t(a,3,c),g,n;switch(f[0]){case 0:case 1:e="";g="d[i-1]";break;default:e="var v=d[i-1];",g="v"}switch(f[1]){case 0:case 1:f="";n="(c-i)";break;default:f="var k=c-i;",n="k"}c=new Function(z,"d","a","for(var i=d.length;i>0;--i){"+e+f+"if(("+s(c,g,n,"a")+")===false){return true;}}return false;");l.set("each_ar",a,c)}this.broken=c(r,b,d)}return this};
y.prototype.at=function(a){var d=this.data;return d[d.length-a-1]};y.prototype.first=function(a,d){if(a)return f.prototype.first.call(this,a,d);var b=this.data;if(0<b.length)return b[b.length-1]};y.prototype.last=function(a,d){if(a)return this.reverse().first(a,d);var b=this.data;if(0<b.length)return b[0]};y.prototype.reverse=function(){return new p(this.data)};y.prototype.zip=function(a,d,b){var c=this;return new f(function(e,f){var g=c.data,l=g.length,m;if("string"==typeof d){var k=[],p=t(d,5,k),
u=[];switch(p[0]){case 0:case 1:m="@d["+l+"-@i-1]";break;default:u.push("(@V=@d["+l+"-@i-1])"),m="@V"}u.push("("+s(k,m,"$","@i","$$","@a")+")");m="("+u.join(",")+")"}else m="@rs(@d["+l+"-@i-1],$,@i,$$,@a)";if("string"==typeof e){k=[];p=t(e,3,k);u=[];switch(p[0]){case 0:case 1:break;default:u.push("(@RS="+m+")"),m="@RS"}switch(p[1]){case 0:case 1:p="(@k++)";break;default:u.push("(@kk=@k++)"),p="@kk"}u.push(s(k,m,p,"@a0"));k="("+u.join(",")+")"}else k="@p("+m+",@k++,@a0)";this.broken=r(a).each("@i>="+
l+"?false:@r="+k+",++@i,@r",{a:b,a0:f,k:0,i:0,d:g,p:e,rs:d}).broken;return this})};A(v,H);H.prototype.each=function(a,d){var b=this.data,c=[],e;for(e in b)c.push(e),c.push(b[e]);if("string"==typeof a){b=l.get("each_or",a);if(!b){var b=[],f=t(a,3,b),g,k;switch(f[0]){case 0:case 1:e="";g="r[ii+1]";break;default:e="var v=r[ii+1];",g="v"}switch(f[1]){case 0:case 1:f="";k="r[ii]";break;default:f="var k=r[ii];",k="k"}b=new Function(z,"r","a","for(var i=r.length/2;i>0;--i){var ii=(i-1)*2;"+e+f+"if(("+s(b,
g,k,"a")+")===false){return true;}}return false;");l.set("each_or",a,b)}this.broken=b(r,c,d)}else{this.broken=!1;for(b=c.length/2;0<b;--b)if(e=2*(b-1),!1===a(c[e+1],c[e],d)){this.broken=!0;break}}return this};H.prototype.reverse=function(){return new v(this.data)};A(v,B);B.prototype._addContext=function(a,d,b,c){this.context.push({keySelector:F(a,3),comparer:F(d,3),desc:b,arg:c})};B.prototype.each=function(a,d){function b(a,b){for(var d=0,e=f.length;d<e;++d){var g=f[d],k=g.keySelector(c[2*a+1],c[2*
a],g.arg),l=g.keySelector(c[2*b+1],c[2*b],g.arg),k=g.comparer?g.comparer(k,l,g.arg):k==l?0:k<l?-1:1;if(0!=k)return(g.desc?-1:1)*k}return 0}var c=[];this.Iterable.each("@push($$),@push($),0",c);var e=r.range(c.length/2).toArray(),f=this.context;e.sort(b);if("string"==typeof a){b=l.get("each_ord",a);if(!b){var g=[],k=t(a,3,g),m,q,p;switch(k[0]){case 0:case 1:m="";q="r[n+1]";break;default:m="var v=r[n+1];",q="v"}switch(k[1]){case 0:case 1:k="";p="r[n]";break;default:k="var k=r[n];",p="k"}b=new Function(z,
"l","r","a","for(var i=0,c=l.length;i<c;++i){var n=l[i]*2;"+m+k+"if(("+s(g,q,p,"a")+")===false)return true;}return false;");l.set("each_ord",a,b)}this.broken=b(r,e,c,d)}else{this.broken=!1;g=0;for(m=e.length;g<m;++g)if(q=2*e[g],!1===a(c[q+1],c[q],d)){this.broken=!0;break}}return this};B.prototype.thenBy=function(a,d,b){this._addContext(a,d,!1,b);return this};B.prototype.thenByDesc=function(a,d,b){this._addContext(a,d,!0,b);return this};r.range=function(a,d,b){switch(arguments.length){case 1:d=a;a=
0;b=1;break;case 2:b=d>a?1:-1}return new f(function(c,e){if("string"==typeof c){var f=0<b?"each_ru":"each_rd",g=l.get(f,c);g||(g=new Function("s","e","st","a","for(var i=s;i"+(0<b?"<":">")+"e;i+=st){if(("+k(c,"i","i","a")+")===false)return true;}return false;"),l.set(f,c,g));this.broken=g(a,d,b,e)}else if(this.broken=!1,0<b)for(f=a;f<d;f+=b){if(!1===c(f,f,e)){this.broken=!0;break}}else for(f=a;f>d;f+=b)if(!1===c(f,f,e)){this.broken=!0;break}return this})};r.repeat=function(a,d){return new f(function(b,
c){if("string"==typeof b){var e=l.get("each_rpt",b);e||(e=new Function("c","e","a","for(var i=0;i<c;++i){if(("+k(b,"e","i","a")+")===false)return true;}return false;"),l.set("each_rpt",b,e));this.broken=e(d,a,c)}else{this.broken=!1;for(e=0;e<d;++e)if(!1===b(a,e,c)){this.broken=!0;break}}return this})};r.setAlias=function(a){z=a};r.Lambda={replace:k,parse:F,getHint:t,join:s};module.exports=r})();
